<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="6K"><title>å¦‚ä½•æ”¯æŒ Gitalk è¯„è®ºåŠŸèƒ½ Â· 6K</title><meta name="description" content="ä¹‹å‰åšå®¢çš„è¯„è®ºç³»ç»Ÿä¸€ç›´ç”¨çš„æ˜¯ disqusï¼Œä½†æ˜¯éœ€è¦ç¿»å¢™ï¼Œå°¤å…¶æ˜¯ç§»åŠ¨ç«¯è®¿é—®çš„æ—¶å€™ï¼Œæ ¹æœ¬å°±åŠ è½½ä¸äº†ï¼ˆé™¤éå¼€äº† VPNï¼‰ã€‚å›½å†…çš„ä¸€äº›è¯„è®ºç³»ç»Ÿï¼š duoshuoã€uyan ä¹Ÿéƒ½æŒ‚äº†ï¼Œä»…å­˜çš„ä¸€äº›ä¸çŸ¥é“å“ªå¤©è¯´ä¸å‡†ä¹Ÿå…³äº†ã€‚æ—¢ç„¶æ˜¯æŠ€æœ¯åšå®¢ï¼Œç”¨ Gitalk è‡ªç„¶æ˜¯æœ€ç›¸ç¬¦çš„ã€‚åŸºäº GitHub issue å’Œ Pr"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/blog/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/blog/css/style.css"><link rel="stylesheet" href="/blog/css/blog_basic.css"><link rel="stylesheet" href="/blog/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/blog/images/avatar.png" style="width:150px;"><h3 title=""><a href="/">6K</a></h3><div class="description"><p>è®¤çœŸåšäº‹ ä½è°ƒåšäºº</p></div></div></div><ul class="social-links"></ul></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/blog/">é¦–é¡µ</a></li><li><a href="https://l19861225q.github.io/blog/archives">å½’æ¡£</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"></a></li></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>å¦‚ä½•æ”¯æŒ Gitalk è¯„è®ºåŠŸèƒ½</a></h3></div><div class="post-content"><p>ä¹‹å‰åšå®¢çš„è¯„è®ºç³»ç»Ÿä¸€ç›´ç”¨çš„æ˜¯ <a href="https://disqus.com/" target="_blank" rel="noopener">disqus</a>ï¼Œä½†æ˜¯éœ€è¦ç¿»å¢™ï¼Œå°¤å…¶æ˜¯ç§»åŠ¨ç«¯è®¿é—®çš„æ—¶å€™ï¼Œæ ¹æœ¬å°±åŠ è½½ä¸äº†ï¼ˆé™¤éå¼€äº† VPNï¼‰ã€‚å›½å†…çš„ä¸€äº›è¯„è®ºç³»ç»Ÿï¼š duoshuoã€uyan ä¹Ÿéƒ½æŒ‚äº†ï¼Œä»…å­˜çš„ä¸€äº›ä¸çŸ¥é“å“ªå¤©è¯´ä¸å‡†ä¹Ÿå…³äº†ã€‚æ—¢ç„¶æ˜¯æŠ€æœ¯åšå®¢ï¼Œç”¨ <a href="https://gitalk.github.io/" target="_blank" rel="noopener">Gitalk</a> è‡ªç„¶æ˜¯æœ€ç›¸ç¬¦çš„ã€‚åŸºäº GitHub issue å’Œ Preact å®ç°ï¼šé¦–å…ˆï¼Œæœ‰å¤§å‚ä¿è¯ç¨³å®šæ€§ï¼›å…¶æ¬¡ï¼Œæ˜¯å–œæ¬¢ Gitalk ç‚¹å‡»è¯„è®ºé¡µé¢çš„åŠ¨æ•ˆï¼Œæœ€åï¼Œä½¿ç”¨ GitHub ID ç™»å½•ï¼Œå¯ä»¥æ‹œè®¿å„ä½å¤§ä½¬çš„ä¸»é¡µğŸ˜Š</p>
<a id="more"></a>
<h3 id="ç”³è¯·-GitHub-Application"><a href="#ç”³è¯·-GitHub-Application" class="headerlink" title="ç”³è¯· GitHub Application"></a>ç”³è¯· GitHub Application</h3><blockquote>
<p>å› ä¸ºé€šè¿‡ GitHub åº”ç”¨é‰´æƒï¼Œæ‰€ä»¥éœ€è¦ <a href="https://github.com/settings/applications/new" target="_blank" rel="noopener">ç”³è¯·å¼€é€š</a> ä¸€ä¸ª application</p>
</blockquote>
<img src="/blog/2019/02/06/how-to-support-gitalk-comments/github-application-new.png">
<ul>
<li><code>Application name</code> åº”ç”¨åç§°ï¼Œå¦‚ï¼šxxx çš„åšå®¢</li>
<li><code>Homepage URL</code> åšå®¢çš„åœ°å€</li>
<li><code>Application description</code> æè¿°ï¼Œå¯ä¸å¡«</li>
<li><code>Authorization callback URL</code> <strong>é‡è¦ï¼ç”¨æ¥æ¥æ”¶é‰´æƒå›è°ƒçš„ tokenï¼Œä¸€èˆ¬å’Œåšå®¢çš„åœ°å€ä¿æŒä¸€è‡´å°±å¥½</strong></li>
</ul>
<h4 id="æ³¨å†Œå®Œæˆä¹‹åï¼Œä¼šå¾—åˆ°-Client-ID-å’Œ-Client-Secretï¼Œç­‰ä¼šå„¿ç”¨åˆ°ã€‚"><a href="#æ³¨å†Œå®Œæˆä¹‹åï¼Œä¼šå¾—åˆ°-Client-ID-å’Œ-Client-Secretï¼Œç­‰ä¼šå„¿ç”¨åˆ°ã€‚" class="headerlink" title="æ³¨å†Œå®Œæˆä¹‹åï¼Œä¼šå¾—åˆ° Client ID å’Œ Client Secretï¼Œç­‰ä¼šå„¿ç”¨åˆ°ã€‚"></a>æ³¨å†Œå®Œæˆä¹‹åï¼Œä¼šå¾—åˆ° Client ID å’Œ Client Secretï¼Œç­‰ä¼šå„¿ç”¨åˆ°ã€‚</h4><img src="/blog/2019/02/06/how-to-support-gitalk-comments/github-oauth.png">
<h3 id="åˆå§‹åŒ–-Gitalk"><a href="#åˆå§‹åŒ–-Gitalk" class="headerlink" title="åˆå§‹åŒ– Gitalk"></a>åˆå§‹åŒ– Gitalk</h3><blockquote>
<p>æˆ‘çš„åšå®¢æ¨¡æ¿è¯­è¨€ç”¨çš„ <a href="http://jade-lang.com/" target="_blank" rel="noopener">Jade</a>ï¼Œåœ¨é€‚å½“çš„åœ°æ–¹å¼•å…¥ CSS å’Œ JS</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// xxx.jade</span><br><span class="line">link(rel=&quot;stylesheet&quot;, href=&quot;https://unpkg.com/gitalk/dist/gitalk.css&quot;)</span><br><span class="line">script(src=&apos;https://unpkg.com/gitalk/dist/gitalk.min.js&apos;)</span><br><span class="line">script.</span><br><span class="line">    (function() &#123;</span><br><span class="line">      var gitalk = new Gitalk(&#123;</span><br><span class="line">        clientID: &apos;#&#123;theme.gitalk.clientId&#125;&apos;,</span><br><span class="line">        clientSecret: &apos;#&#123;theme.gitalk.clientSecret&#125;&apos;,</span><br><span class="line">        repo: &apos;#&#123;theme.gitalk.repo&#125;&apos;,</span><br><span class="line">        owner: &apos;#&#123;theme.gitalk.owner&#125;&apos;,</span><br><span class="line">        admin: [&apos;#&#123;theme.gitalk.admin&#125;&apos;],</span><br><span class="line">        labels: [&apos;#&#123;theme.gitalk.labels&#125;&apos;],</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      gitalk.render(&apos;xxx&apos;)</span><br><span class="line">    &#125;)();</span><br></pre></td></tr></table></figure>
<ul>
<li><code>clientID</code>, <code>clientSecret</code> å¡«å†™ä¸Šä¸€æ­¥ç”³è¯·å¾—åˆ°çš„</li>
<li><code>repo</code> å¯¹åº”åˆ°ä¸€ä¸ª GitHub repoï¼Œå»ºè®®å•ç‹¬åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œä¾‹å¦‚ï¼šgitalk</li>
<li><code>owner</code> Repo æ‹¥æœ‰è€…çš„ç”¨æˆ·åï¼Œä¹Ÿå¯ä»¥æ˜¯ç»„ç»‡</li>
<li><code>admin</code> Repo æ‹¥æœ‰è€…æˆ–åä½œè€…ï¼Œå’Œ <code>owner</code> å¡«ä¸€æ ·å³å¯</li>
<li><code>labels</code> å¯¹åº” Repo issue çš„ labelsï¼Œé»˜è®¤æ˜¯ [â€˜Gitalkâ€™]</li>
</ul>
<p><em>æ›´å¤š Gitalk çš„è¯¦ç»†é…ç½®ï¼Œå¯å‚è€ƒ <a href="https://github.com/gitalk/gitalk#options" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></em></p>
<blockquote>
<p><code>gitalk.render(&#39;xxx&#39;)</code> å°†æŒ‚è½½åˆ° id=â€xxxâ€ çš„ DOM ä¸Š</p>
</blockquote>
<p>hexo ç›¸å…³çš„é…ç½®ç¤ºä¾‹ï¼š<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#_config.yml</span></span><br><span class="line"><span class="attr">gitalk:</span></span><br><span class="line"><span class="attr">  clientId:</span> <span class="string">xxx</span></span><br><span class="line"><span class="attr">  clientSecret:</span> <span class="string">xxx</span></span><br><span class="line"><span class="attr">  repo:</span> <span class="string">gitalk</span></span><br><span class="line"><span class="attr">  owner:</span> <span class="string">xxx</span></span><br><span class="line"><span class="attr">  admin:</span> <span class="string">xxx</span></span><br><span class="line"><span class="attr">  labels:</span> <span class="string">gitalk</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Gitalk-ID-çš„é—®é¢˜"><a href="#Gitalk-ID-çš„é—®é¢˜" class="headerlink" title="Gitalk ID çš„é—®é¢˜"></a>Gitalk ID çš„é—®é¢˜</h3><p>è¯¥é€‰é¡¹é»˜è®¤å€¼æ˜¯ <code>location.href</code>ï¼Œç”¨æ¥æŒ‡å®šé¡µé¢çš„å”¯ä¸€ idï¼Œä½†æ˜¯æœ‰é•¿åº¦é™åˆ¶ï¼Œä¸èƒ½è¶…è¿‡ 50ã€‚æ˜¾ç„¶ï¼Œåšå®¢åœ°å€å¾ˆå®¹æ˜“è¶…è¿‡è¿™ä¸ªé•¿åº¦ã€‚è¿™é‡Œçš„è§£å†³åŠæ³•æ˜¯å¼•å…¥ä¸€ä¸ª <a href="https://www.npmjs.com/package/blueimp-md5" target="_blank" rel="noopener">md5</a> åº“ï¼Œå¯¹ href åŠ å¯†å¤„ç†ã€‚å¦å¤–ï¼Œ<code>location.href</code> å¯èƒ½ä¼šè¢«åˆ†äº«å¹³å°æ”¹å†™ï¼ˆå¾®ä¿¡åˆ†äº«æ—¶ä¼šé™„å¸¦ä¸€å † querystringï¼‰ï¼Œæ”¹ç”¨ <code>location.pathname</code> æœ€ç¨³å¦¥ã€‚</p>
<p>æ›´æ–°æ¨¡ç‰ˆé…ç½®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// xxx.jade</span><br><span class="line">script(src=&apos;https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js&apos;)</span><br><span class="line">...</span><br><span class="line">script.</span><br><span class="line">    (function() &#123;</span><br><span class="line">      var gitalk = new Gitalk(&#123;</span><br><span class="line">        clientID: &apos;#&#123;theme.gitalk.clientId&#125;&apos;,</span><br><span class="line">        clientSecret: &apos;#&#123;theme.gitalk.clientSecret&#125;&apos;,</span><br><span class="line">        id: md5(#theme.gitalk.id)</span><br><span class="line">        ...</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;)();</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>æ›´æ–°é¡¹ç›®é…ç½®ï¼š</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _config.yml</span></span><br><span class="line"><span class="attr">gitalk:</span></span><br><span class="line">  <span class="string">...</span></span><br><span class="line"><span class="attr">  id:</span> <span class="string">location.pathname</span></span><br></pre></td></tr></table></figure>
<h3 id="è®°å¾—å…³è”-issue"><a href="#è®°å¾—å…³è”-issue" class="headerlink" title="è®°å¾—å…³è” issue"></a>è®°å¾—å…³è” issue</h3><p>ç»è¿‡ä¸Šè¿°çš„æ“ä½œï¼Œå·²ç»æ¥å…¥äº† Gitalk æ¥å½“ä½œè¯„è®ºç³»ç»Ÿä½¿ç”¨ã€‚</p>
<img src="/blog/2019/02/06/how-to-support-gitalk-comments/issue-init.png">
<p>æ–‡ç« è¯„è®ºå¯¹åº” repo é‡Œçš„æŸæ¡ issueï¼Œéœ€è¦åˆå§‹åŒ–è¿›è¡Œå…³è”ã€‚å½“ç„¶ï¼Œå¦‚æœè¿™ç¯‡æ–‡ç« ä½ ä¸å¸Œæœ›æ”¯æŒè¯„è®ºï¼Œå°±ä¸ç”¨å…³è”äº†ã€‚<br>æœ€ç»ˆè¯„è®ºçš„æ ·å­</p>
<img src="/blog/2019/02/06/how-to-support-gitalk-comments/comments-demo.png">
<p>å®Œç»“ï¼Œæ’’èŠ± ğŸ‰</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2019-02-06</span><i class="fa fa-tag"></i><a href="/blog/categories/git/" title="git" class="tag">git </a><a href="/blog/tags/gitalk/" title="gitalk" class="tag">gitalk </a><a href="/blog/tags/comments/" title="comments" class="tag">comments </a></div></div></div></div><div class="share"><div class="evernote"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"><a href="http://twitter.com/home?status=,https://l19861225q.github.io/blog/2019/02/06/how-to-support-gitalk-comments/,6K,å¦‚ä½•æ”¯æŒ Gitalk è¯„è®ºåŠŸèƒ½,;" class="fa fa-twitter"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a role="navigation" href="/blog/2020/01/01/summary-of-2019/" title="2019 å¹´çš„æ€»ç»“" class="btn">ä¸Šä¸€ç¯‡</a></li><li class="next pagbuttons"><a role="navigation" href="/blog/2019/02/02/how-to-config-gitlab-ci/" title="å¦‚ä½•é…ç½® GitLab CI" class="btn">ä¸‹ä¸€ç¯‡</a></li></ul></div></div></div></div></div><script src="/blog/js/jquery.js"></script><script src="/blog/js/jquery-migrate-1.2.1.min.js"></script><script src="/blog/js/jquery.appear.js"></script></body></html>